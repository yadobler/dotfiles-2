# vim:ft=hyprlang

##################
## Yukna config ##
##################

source = ./colors.conf
# GLOBAL VARIABLES

$menu_paste = ~/.config/scripts/paste_menu.sh
$term = footclient
$filebrowser = thunar
$webbrowser = brave --gtk-version=4 --enable-features=UseOzonePlatform --ozone-platform=wayland --enable-wayland-ime --enable-features=WaylandWindowDecorations
$volume = ~/.config/scripts/volume.sh
$brightness = ~/.config/scripts/brightness.sh
$launcher1 = ~/.config/scripts/app_launcher.sh
$launcher2 = ~/.config/scripts/icon_launcher.sh
$powermenu = ~/.config/scripts/powermenu_launcher.sh
$selective_kill = ~/.config/scripts/selective_kill.sh

$printscr_savepath = ~/Pictures/Screenshots/$(date +'%Y%m%d-%H%M%S')
$printscr_fullscreen = grim
$printscr_select = grim -g "$(slurp)"
$printscr_sf = $printscr_fullscreen - | tee $(echo $printscr_savepath)-original.png | swappy -f -
$printscr_f = $printscr_fullscreen - | tee $(echo $printscr_savepath)-full.png | wl_copy
$printscr_ss = $printscr_select - | tee $(echo $printscr_savepath)-original.png | swappy -f -
$printscr_sw = ~/.config/scripts/print_window.sh

$scratchpad_name = 󰉇

# DISPLAY

monitor = eDP-1, 3000x2000@60, 0x0, 2
monitor =, preferred,auto,auto

# STARTUP
exec-once = bash ~/.config/scripts/hyprland-plugin-script.sh
exec-once = foot --server
exec-once = hypridle
exec-once = wbg $wallpaper
exec-once = waybar
exec-once = iio-hyprland
exec-once = dunst
exec-once = lxqt-policykit-agent
exec-once = wl-paste --watch cliphist store
exec-once = light -N 5
exec-once = pulseaudio -D
exec-once = blueman-tray
exec-once = rfkill block bluetooth
exec-once = ~/.config/scripts/start_ime.sh
exec-once = ~/.config/scripts/start_squeekboard.sh
# exec-once = ~/.config/scripts/lisgd_touchscreen.sh
# exec-once = gio launch .config/autostart/*

# ENV VAR

env = XCURSOR_SIZE,24
env = QT_QPA_PLATFORM,wayland
env = XDG_CURRENT_DESKTOP,hyprland
env = _JAVA_AWT_WM_NONREPARENTING,1
env = XMODIFIERS,@im=fcitx
env = GTK_IM_MODULE,wayland
env = QT_IM_MODULE,fcitx
env = RANGER_LOAD_DEFAULT_RC,FALSE
env = SCRATCHPAD_NAME,$scratchpad_name

# SETTINGS

input {
    kb_layout = us

   follow_mouse = 1

   touchpad {
       natural_scroll = true
       disable_while_typing = true
       middle_button_emulation = true
   }

    # -1.0 - 1.0, 0 means no modification.
    sensitivity = 0 
}

decoration {
    drop_shadow = false
    rounding = 0
    shadow_range = 10
    shadow_render_power = 2
    col.shadow = rgba($color13ee)
    active_opacity = 1.0
    inactive_opacity = 0.875
}

animations {
    enabled = true
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows,        1, 7,   myBezier
    animation = windowsOut,     1, 5,   default, popin 80%
    animation = border,         1, 10,  myBezier
    animation = borderangle,    1, 8,   default
    animation = fade,           1, 7,   default
    animation = workspaces,     1, 6,   default
}

dwindle {
    pseudotile = true 
    preserve_split = true 
}

master {
    new_is_master = true
}

misc {
    disable_hyprland_logo = true
    # force_hypr_chan = true
    # enable_swallow = false
    # swallow_regex = ^(foot)$
    vfr = true
}

general {
    gaps_in = 5
    gaps_out = 10
    border_size = 2
    col.active_border = rgba($color14ee)
    col.inactive_border = rgba($color1ff)
    layout = dwindle
    resize_on_border = true
}

# WINDOW RULES

$spd_opacity = 0.9
windowrule = opacity $spd_opacity, ^(foot)$
windowrule = opacity $spd_opacity, ^(org.pwmt.zathura)$

windowrule = float, org.kde.polkit-kde-authentication-agent-1
windowrule = center, org.kde.polkit-kde-authentication-agent-1

windowrule = pseudo, fcitx

windowrule = float,     ^(wofi)$
windowrule = center,    ^(wofi)$
windowrule = noanim,    ^(wofi)$
windowrule = noborder,  ^(wofi)$
windowrule = plugin:hyprbars:nobar, ^(wofi)$

windowrule = float,                ^(org.telegram.desktop)$
windowrule = center,               ^(org.telegram.desktop)$
windowrule = opacity $spd_opacity, ^(org.telegram.desktop)$

windowrule = float,                ^(brave-calendar.google.com__calendar_u_1_r-Default)$
windowrule = size 70% 70%,         ^(brave-calendar.google.com__calendar_u_1_r-Default)$
windowrule = opacity $spd_opacity, ^(brave-calendar.google.com__calendar_u_1_r-Default)$
windowrule = center,               ^(brave-calendar.google.com__calendar_u_1_r-Default)$

windowrule = float,                ^(brave-mail.google.com__mail_u_.-Default)$
windowrule = size 70% 70%,         ^(brave-mail.google.com__mail_u_.-Default)$
windowrule = opacity $spd_opacity, ^(brave-mail.google.com__mail_u_.-Default)$
windowrule = center,               ^(brave-mail.google.com__mail_u_.-Default)$

windowrule = float,                ^(ncspot)$
windowrule = size 70% 70%,         ^(ncspot)$
windowrule = opacity $spd_opacity, ^(ncspot)$
windowrule = center,               ^(ncspot)$

windowrule = float,                ^(brave-to-do.live.com.+)$
windowrule = size 70% 70%,         ^(brave-to-do.live.com.+)$
windowrule = opacity $spd_opacity, ^(brave-to-do.live.com.+)$
windowrule = center,               ^(brave-to-do.live.com.+)$

windowrule = float,                ^(brave-web.whatsapp.com.+)$
windowrule = size 70% 70%,         ^(brave-web.whatsapp.com.+)$
windowrule = opacity $spd_opacity, ^(brave-web.whatsapp.com.+)$
windowrule = center,               ^(brave-web.whatsapp.com.+)$

windowrule = float,                ^(brave-keep.google.com.+)$
windowrule = size 70% 70%,         ^(brave-keep.google.com.+)$
windowrule = opacity $spd_opacity, ^(brave-keep.google.com.+)$
windowrule = center,               ^(brave-keep.google.com.+)$

windowrule = float,                ^(brave-open.spotify.com.+)$
windowrule = size 70% 70%,         ^(brave-open.spotify.com.+)$
windowrule = opacity $spd_opacity, ^(brave-open.spotify.com.+)$
windowrule = center,               ^(brave-open.spotify.com.+)$


# KEY BINDINGS

$mainMod = SUPER

# GLOBAL KEYS

bind = $mainMod SHIFT, C,      exec,             hyprctl reload
bind = $mainMod SHIFT, Q,      killactive, 
bind = $mainMod SHIFT, T,      exec,             ~/.config/scripts/animations.sh toggle
bind = $mainMod SHIFT, O,      pseudo, 
bind = $mainMod,       V,      exec,             $menu_paste
bind = $mainMod,       Return, exec,             $term
bind = $mainMod,       E,      exec,             thunar
bind = $mainMod,       B,      exec,             $webbrowser
bind = $mainMod,       N,      exec,             swaync-client -t -sw
bind = $mainMod,       Escape, exec,             $powermenu
bind = $mainMod,       Tab,    togglesplit, 
bind = ALT,            Space,  exec,             $launcher1
bind = ALT,            Tab,    cyclenext, 
bind = ALT,            Tab,    bringactivetotop, 
bind = ALT      SHIFT, Tab,    cyclenext,        prev
bind = ALT      SHIFT, Tab,    bringactivetotop, 

# FUNCTION BUTTONS

bindm= $mainMod, mouse:272,                     movewindow
bindm= $mainMod, mouse:273,                     resizewindow
# This only triggers when turning camera around
# bindl=,          switch[HP WMI camera shutter], exec,         notify-send.sh test

bindm= $mainMod, mouse:272,                     movewindow
bindm= $mainMod, mouse:273,                     resizewindow
bindl=,          XF86MonBrightnessUp,           exec,         $brightness up 5
bindl=,          XF86MonBrightnessDown,         exec,         $brightness down 5
bindl=,          XF86AudioMute,                 exec,         $volume mute
bindl=,          XF86AudioLowerVolume,          exec,         $volume down 5
bindl=,          XF86AudioRaiseVolume,          exec,         $volume up 5
bind =,          XF86AudioMicMute,              exec,         wpctl set-mute @DEFAULT_SOURCE@ toggle
bind =,          XF86AudioPrev,                 exec,         playerctl previous
bind =,          XF86AudioNext,                 exec,         playerctl next
bind =,          XF86AudioPlay,                 exec,         playerctl play-pause
bind = SHIFT,    F9,                            exec,         playerctl position 5-
bind = SHIFT,    F6,                            exec,         $volume down 1
bind = SHIFT,    F7,                            exec,         $volume up 1
bind = SHIFT,    F3,                            exec,         $brightness up 1
bind = SHIFT,    F2,                            exec,         $brightness down 1
bind = SHIFT,    F11,                           exec,         playerctl position 5+

# PRINT SCREEN

bind=CONTROL SHIFT,Print, exec, $printscr_sw
bind=SHIFT,Print, exec, $printscr_ss
bind=$mainMod, Print, exec, $printscr_f
bind=,Print, exec, $printscr_sf

# MODES

# bindr=,          swipe:4:u, submap, resize
bind = $mainMod, W,         submap, resize
submap = resize
    bind =,         W,      cyclenext, 
    bind =,         W,      bringactivetotop, 
    bind =,         W,      submap, reset

    bind = SHIFT,   W,      cyclenext, prev
    bind = SHIFT,   W,      bringactivetotop, 
    bind = SHIFT,   W,      submap, reset

    bind =,         Q,      exec, $selective_kill
    bind =,         Q,      submap, reset

    bind = SHIFT,   Q,      killactive, 
    bind = SHIFT,   Q,      submap, reset

    bind = SHIFT,   F,      fullscreen, 0
    bind = SHIFT,   F,      submap, reset
    bind =,         F,      fullscreen, 1
    bind =,         F,      submap, reset

    bind =,         Space,  togglefloating, 
    bind =,         Space,  centerwindow, 
    bind =,         C,      centerwindow, 

    bind =,         Tab,    togglesplit, 
    bind =,         h,      movefocus, l
    bind =,         l,      movefocus, r
    bind =,         k,      movefocus, u
    bind =,         j,      movefocus, d

    bind = SHIFT,   h,      movewindow,   l
    bind = SHIFT,   l,      movewindow,   r
    bind = SHIFT,   k,      movewindow,   u
    bind = SHIFT,   j,      movewindow,   d
    bind =, swipe:3:l,      movewindow,   l
    bind =, swipe:3:r,      movewindow,   r
    bind =, swipe:3:u,      movewindow,   u
    bind =, swipe:3:d,      movewindow,   d

    bind = CONTROL, h,      resizeactive, l
    bind = CONTROL, l,      resizeactive, r
    bind = CONTROL, k,      resizeactive, u
    bind = CONTROL, j,      resizeactive, d

    bind =,         1,      workspace, 1
    bind =,         2,      workspace, 2
    bind =,         3,      workspace, 3
    bind =,         4,      workspace, 4
    bind =,         5,      workspace, 5
    bind =,         6,      workspace, 6
    bind =,         7,      workspace, 7
    bind =,         8,      workspace, 8
    bind =,         9,      workspace, 9
    bind =,         Comma,  workspace, r-1
    bind =,         Period, workspace, r+1
    bind = SHIFT,   1,      movetoworkspacesilent, 1
    bind = SHIFT,   2,      movetoworkspacesilent, 2
    bind = SHIFT,   3,      movetoworkspacesilent, 3
    bind = SHIFT,   4,      movetoworkspacesilent, 4
    bind = SHIFT,   5,      movetoworkspacesilent, 5
    bind = SHIFT,   6,      movetoworkspacesilent, 6
    bind = SHIFT,   7,      movetoworkspacesilent, 7
    bind = SHIFT,   8,      movetoworkspacesilent, 8
    bind = SHIFT,   9,      movetoworkspacesilent, 9
    bind = SHIFT,   Comma,  movetoworkspacesilent, r-1
    bind = SHIFT,   Period, movetoworkspacesilent, r+1

    bindm=,         mouse:272,   movewindow
    bindm=,         mouse:273,   resizewindow
    bindm=,         longpress:1, movewindow
    bindm=,         longpress:2, resizewindow
    bind =,         tap:3,       togglefloating, 
#bind =,         tap:4,       submap,         reset
    bindr = SHIFT, 0, movetoworkspacesilent, special:$scratchpad_name
    bindr =,       0, exec, ~/.config/scripts/swap_scratchpad.sh

    bind =,          Escape, submap, reset
    bind = $mainMod, W,      submap, reset
submap = reset

# WORKSPACE AND WINDOWS

bind = $mainMod, 1,          workspace, 1
bind = $mainMod, 2,          workspace, 2
bind = $mainMod, 3,          workspace, 3
bind = $mainMod, 4,          workspace, 4
bind = $mainMod, 5,          workspace, 5
bind = $mainMod, 6,          workspace, 6
bind = $mainMod, 7,          workspace, 7
bind = $mainMod, 8,          workspace, 8
bind = $mainMod, 9,          workspace, 9
bindr= $mainMod, 0,          exec,      ~/.config/scripts/swap_scratchpad.sh
bind = $mainMod, Comma,      workspace, r-1
bind = $mainMod, Period,     workspace, r+1
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up,   workspace, e-1

bind = $mainMod SHIFT, 1, movetoworkspacesilent, 1
bind = $mainMod SHIFT, 2, movetoworkspacesilent, 2
bind = $mainMod SHIFT, 3, movetoworkspacesilent, 3
bind = $mainMod SHIFT, 4, movetoworkspacesilent, 4
bind = $mainMod SHIFT, 5, movetoworkspacesilent, 5
bind = $mainMod SHIFT, 6, movetoworkspacesilent, 6
bind = $mainMod SHIFT, 7, movetoworkspacesilent, 7
bind = $mainMod SHIFT, 8, movetoworkspacesilent, 8
bind = $mainMod SHIFT, 9, movetoworkspacesilent, 9
bindr= $mainMod SHIFT, 0, movetoworkspacesilent, special:$scratchpad_name
bind = $mainMod SHIFT, Comma, movetoworkspacesilent, r-1
bind = $mainMod SHIFT, Period, movetoworkspacesilent, r+1

bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow
bindm = $mainMod, longpress:2, movewindow
bindm = $mainMod, longpress:3, resizewindow

# GESTURES

gestures {
    workspace_swipe = on
    workspace_swipe_fingers = 4
    workspace_swipe_distance = 200
    workspace_swipe_cancel_ratio = 0.1
}

plugin {
    hyprbars {
        bar_height = 30
        bar_color = rgba($color14AA)
        bar_precedence_over_border = 1
        bar_part_of_window = 1
        # bar_color -> (col) bar's background color
        # bar_height -> (int) bar's height (default 15)
        # col.text -> (col) bar's title text color
        # bar_title_enabled -> (bool) whether to render the title (default true)
        # bar_text_size -> (int) bar's title text font size (default 10)
        # bar_text_font -> (str) bar's title text font (default Sans)
        # bar_text_align -> (str) bar's title text alignment (default center, can also be left)
        # bar_buttons_alignment -> (str) bar's buttons alignment (default: right, can also be left)
        # bar_part_of_window -> (bool) whether the bar is a part of the main window (if it is, stuff like shadows render around it)
        # bar_precedence_over_border -> (bool) whether the bar should have a higher priority than the border (border will be around the bar)
        # bar_padding -> (int) left / right edge padding (default 7)
        # bar_button_padding -> (int) padding between the buttons (default 5)

        # example buttons (R -> L)
        # hyprbars-button = color, size, on-click
        hyprbars-button = rgb($color3), 20, 󰖭, hyprctl dispatch exec ~/.config/scripts/selective_kill.sh
        hyprbars-button = rgb($color3), 20, , hyprctl dispatch fullscreen 1
        hyprbars-button = rgb($color3), 20, , hyprctl dispatch movetoworkspacesilent special:$scratchpad_name
    }
    touch_gestures {
        sensitivity = 5.0
        long_press_delay = 500
        # must be >= 3
        workspace_swipe_fingers = 4
        experimental {
            send_cancel = 0
        }
    }
}
